l=1
Sigma = c( (l+2)/(l+4), -2/(l+4),
-2/(l+4),(l+2)/(l+4))
sqrt(Sigma)
eigen(Sigma)
Sigma = matrix(c( (l+2)/(l+4), -2/(l+4),
-2/(l+4),(l+2)/(l+4)),2)
eigen(Sigma)
ev= eigen(Sigma)
V = ev$values
sqrtMat<-function(Sigma){
ev= eigen(Sigma)
Q= ev$vectors
V = ev$values
Q%*%sqrt(V)%*%t(Q)
}
sqrtMat(Sigma)
sqrtMat<-function(Sigma){
ev= eigen(Sigma)
Q= ev$vectors
V = ev$values
Q%*%diag(sqrt(V))%*%t(Q)
}
sqrtMat<-function(Sigma){
ev= eigen(Sigma)
Q= ev$vectors
V = ev$values
V[V<0]=0
Q%*%diag(sqrt(V))%*%t(Q)
}
sqrtMat(Sigma)
sqrtMat(Sigma)%*%sqrtMat(Sigma)
sqrtMat(Sigma)%*%sqrtMat(Sigma) - Sigma
l=2
Sigma = matrix(c( (l+2)/(l+4), -2/(l+4),
-2/(l+4),(l+2)/(l+4)),2)
sqrtMat<-function(Sigma){
ev= eigen(Sigma)
Q= ev$vectors
V = ev$values
V[V<0]=0
Q%*%diag(sqrt(V))%*%t(Q)
}
sqrtMat(Sigma)%*%sqrtMat(Sigma) - Sigma
Sigma
Sigma <- function(l){
matrix(c( (l+2)/(l+4), -2/(l+4),
-2/(l+4),(l+2)/(l+4)),2)
}
Sigma <- function(l){
matrix(c( (l+2)/(l+4), -2/(l+4),
-2/(l+4),(l+2)/(l+4)),2)
}
Mu <- function(l){
2/(l+4)
}
l
(Mu(l)-Mu(0))
Wass<-function(l){
C1= Sigma(l)
C2= Sigma(0)
C1half=sqrtMat(C1)
M1= Mu(l)
M2= Mu(0)
W2=(M1-M2)^2*2+ sum(diag(C1+C2- 2* sqrtMat(C1half%*%C2%*%C1half)))
sqrt(W2)
}
Wass(1)
sapply(seq(0,1E-3,length.out = 100),Wass)
result<- sapply(seq(0,1E-3,length.out = 100),Wass)
plot(result)
result<- sapply(seq(0,1E-3,length.out = 100),Wass)
plot(result)
l= c(1:10)
result<- sapply(exp(-l),Wass)
plot(l,result)
result<- sapply(10^(-l),Wass)
plot(l,result)
l= seq(0,10,length.out = 100)
result<- sapply(10^(-l),Wass)
plot(l,result)
require("ggplot2")
data.frame("log.lambda"=l,"W2"=result)
df=data.frame("log.lambda"=l,"W2"=result)
df=data.frame("log10.lambda"=l,"W.2"=result)
ggplot(df,aes(x=log10.lambda,y=W2))
ggplot(df,aes(x=log10.lambda,y=W.2))+ geom_line()
ggplot(df,aes(x=log10.lambda,y=W.2))+ geom_line()+theme_bw()
l= -seq(0,10,length.out = 100)
result<- sapply(10^(-l),Wass)
require("ggplot2")
df=data.frame("log10.lambda"=l,"W.2"=result)
ggplot(df,aes(x=log10.lambda,y=W.2))+ geom_line()+theme_bw()
l= seq(0,10,length.out = 100)
result<- sapply(10^(-l),Wass)
require("ggplot2")
df=data.frame("-log10.lambda"=l,"W.2"=result)
ggplot(df,aes(x=-log10.lambda,y=W.2))+ geom_line()+theme()
df=data.frame("log10.lambda"=l,"W.2"=result)
ggplot(df,aes(x=log10.lambda,y=W.2))+ geom_line()+theme()
ggplot(df,aes(x=log10.lambda,y=W.2))+ geom_line()+theme_bw()
pdf("../../draft/two_normal_wass.pdf",5,3)
ggplot(df,aes(x=log10.lambda,y=W.2))+ geom_line()+theme_bw()
dev.off()
